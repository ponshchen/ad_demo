<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>content-gallery h5 template</title>
  <style>
    * {
      margin: 0;
    }

    body {
      background-color: transparent;
    }
  </style>
</head>
<body>
  <div id="weather"></div>
</body>
<script>
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
  } else {
    window.alert("Geolocation is not supported by this browser.");
  }

  function successFunction(position) {
    const { longitude, latitude } = position.coords

    fetch(`http://maps.google.com/maps/api/geocode/json?latlng=${latitude},${longitude}&language=zh-TW&sensor=true`)
      .then(function (response) {
        return response.json();
      })
      .then(function (myJson) {
        console.log(myJson);
      });

    const newDiv = document.createElement("div");

    // and give it some content
    const newContent = document.createTextNode(`經度：${longitude}, 緯度：${latitude}`);

    // add the text node to the newly created div
    newDiv.appendChild(newContent);

    // add the newly created element and its content into the DOM
    const currentDiv = document.getElementById("weather");
    document.body.insertBefore(newDiv, currentDiv);
  }

  function errorFunction() {
    window.alert("Unable to retrieve your location.");
  }


  fetch("https://opendata.cwb.gov.tw/api/v1/rest/datastore/F-C0032-001?Authorization=CWB-99677EBA-5811-41DC-AEC3-39EA38447E58&locationName=臺北市")
  .then(function (response) {
        return response.json();
      })
      .then(function (myJson) {
        console.log(myJson.records.location[0].weatherElement);
      });
</script>
</html>
